---
// src/components/Accessibility/AccessibilityPanel.astro
---

<!-- Accessibility Panel (initially hidden) -->
<div id="accessibilityPanel" class="accessibility-popup-overlay">
  <div class="accessibility-popup-container">
    <!-- Header -->
    <div class="accessibility-header">
      <div class="accessibility-header-content">
        <div class="accessibility-logo">
          <svg class="accessibility-icon" viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="12" r="10"></circle>
            <circle cx="12" cy="8" r="2"></circle>
            <path d="M12 14v6M8 18h8"></path>
          </svg>
          <h2>Accessibility Options</h2>
        </div>
        <button id="closeAccessibilityPanel" class="close-accessibility-btn" aria-label="Close accessibility options">
          ✕
        </button>
      </div>
      <p class="accessibility-description">
        Customize your browsing experience with these helpful tools
      </p>
    </div>

    <!-- Panel Content -->
    <div class="accessibility-content">
      
      <!-- Site Assists Section -->
      <section class="accessibility-section">
        <h3 class="section-title">Site Assists</h3>
        <p class="section-description">Optional enhancements that work alongside your existing tools</p>
        
        <div class="accessibility-controls">
          <!-- Keyboard Helpers -->
          <div class="control-item">
            <div class="control-info">
              <label for="keyboardHelpers" class="control-label">Keyboard Helpers</label>
              <p class="control-description">Enhanced focus indicators and arrow-key navigation</p>
            </div>
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                id="keyboardHelpers"
                data-setting="keyboardHelpers"
                aria-describedby="keyboard-help-desc">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <!-- Screen Reader Helpers -->
          <div class="control-item">
            <div class="control-info">
              <label for="screenReaderHelpers" class="control-label">Screen Reader Helpers</label>
              <p class="control-description">Additional announcements and navigation hints</p>
            </div>
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                id="screenReaderHelpers"
                data-setting="screenReaderHelpers"
                aria-describedby="screen-reader-help-desc">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </section>

      <!-- Plain Text Reading Mode -->
      <section class="accessibility-section">
        <h3 class="section-title">Reading Mode</h3>
        <p class="section-description">Simplified layout for focused reading</p>
        
        <div class="plain-text-controls">
          <!-- Plain Text Mode Toggle -->
          <div class="plain-text-main">
            <button 
              id="plainTextToggle"
              class="plain-text-btn"
              data-setting="plainTextMode"
              aria-pressed="false">
              <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
              </svg>
              <span>Toggle Plain Text Mode</span>
            </button>
            <p class="keyboard-shortcut">Press <kbd>T</kbd> to toggle</p>
          </div>

          <!-- Plain Text Customization (shown when mode is active) -->
          <div id="plainTextCustomization" class="plain-text-customization" style="display: none;">
            
            <!-- Font Size -->
            <div class="customization-group">
              <label for="fontSize" class="customization-label">
                Font Size: <span id="fontSizeValue">100%</span>
              </label>
              <input 
                type="range" 
                id="fontSize" 
                min="75" 
                max="200" 
                value="100" 
                step="25"
                class="range-slider"
                data-setting="fontSize">
              <div class="range-labels">
                <span>75%</span>
                <span>100%</span>
                <span>125%</span>
                <span>150%</span>
                <span>200%</span>
              </div>
            </div>

            <!-- Line Spacing -->
            <div class="customization-group">
              <label for="lineSpacing" class="customization-label">
                Line Spacing: <span id="lineSpacingValue">160%</span>
              </label>
              <input 
                type="range" 
                id="lineSpacing" 
                min="120" 
                max="300" 
                value="160" 
                step="20"
                class="range-slider"
                data-setting="lineSpacing">
              <div class="range-labels">
                <span>120%</span>
                <span>200%</span>
                <span>300%</span>
              </div>
            </div>

            <!-- Font Family -->
            <div class="customization-group">
              <label for="fontFamily" class="customization-label">Reading Font</label>
              <select id="fontFamily" class="font-select" data-setting="fontFamily">
                <option value="default">Default Font</option>
                <option value="atkinson">Atkinson Hyperlegible</option>
                <option value="opendyslexic">OpenDyslexic</option>
              </select>
            </div>

            <!-- Background Color -->
            <div class="customization-group">
              <label class="customization-label">Background Color</label>
              <div class="color-options">
                <label class="color-option">
                  <input type="radio" name="backgroundColor" value="white" data-setting="backgroundColor" checked>
                  <span class="color-swatch" style="background: #ffffff; border: 2px solid #e0e0e0;"></span>
                  <span class="color-label">White</span>
                </label>
                <label class="color-option">
                  <input type="radio" name="backgroundColor" value="cream" data-setting="backgroundColor">
                  <span class="color-swatch" style="background: #f5f5dc;"></span>
                  <span class="color-label">Cream</span>
                </label>
                <label class="color-option">
                  <input type="radio" name="backgroundColor" value="blue" data-setting="backgroundColor">
                  <span class="color-swatch" style="background: #e6f3ff;"></span>
                  <span class="color-label">Blue</span>
                </label>
                <label class="color-option">
                  <input type="radio" name="backgroundColor" value="pink" data-setting="backgroundColor">
                  <span class="color-swatch" style="background: #ffe6f0;"></span>
                  <span class="color-label">Pink</span>
                </label>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- Feedback Section -->
      <section class="accessibility-section">
        <h3 class="section-title">Help Us Improve</h3>
        <p class="section-description">Your feedback helps us make our website better for everyone</p>
        
        <div class="feedback-actions">
          <a 
            href="mailto:hello@icthemoon.com?subject=Accessibility%20Feature%20Request" 
            class="feedback-link"
            target="_blank"
            rel="noopener noreferrer">
            <svg class="link-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"/>
            </svg>
            Request an Accessibility Feature
          </a>
          
          <button 
            id="shareAccessibilityTips" 
            class="feedback-link feedback-button"
            type="button">
            <svg class="link-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"/>
            </svg>
            Share Accessibility Tips
          </button>
        </div>
      </section>

    </div>

    <!-- Panel Footer -->
    <div class="accessibility-footer">
      <p class="footer-note">
        These settings are saved locally and work alongside your existing assistive technologies.
      </p>
      <div class="footer-links">
        <a href="/accessibility-statement" class="footer-link">Accessibility Statement</a>
        <span class="footer-separator">•</span>
        <button id="resetAccessibilitySettings" class="footer-link footer-button" type="button">
          Reset All Settings
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Live region for announcements (only active when screen reader helpers enabled) -->
<div 
  id="accessibilityLiveRegion" 
  class="sr-only" 
  aria-live="polite" 
  aria-atomic="true">
</div>

<style>
  @import './accessabilityPanel.css';
</style>

<script src="./accessibilityPanel.js"></script>